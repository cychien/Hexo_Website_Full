<!DOCTYPE html>
<html lang="zh-tw">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="記錄著成長點滴">
    

    <!--Author-->
    
        <meta name="author" content="Justin Chien">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Handlebars模板引擎(2) - Handlebars的使用"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="記錄著成長點滴" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Justin Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Handlebars模板引擎(2) - Handlebars的使用 - Justin Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">
    <style>

    .homepage-hero-module {
      border-right: none;
      border-left: none;
      position: relative;
    }

    .no-video .video-container video,
    .touch .video-container video {
      display: none;
    }

    .no-video .video-container .poster,
    .touch .video-container .poster {
      display: block !important;
    }

    .video-container {
      position: relative;
      bottom: 0%;
      left: 0%;
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: #000;
    }

    .video-container .poster img {
      width: 100%;
      bottom: 0;
      position: absolute;
    }

    .video-container .filter {
      z-index: 100;
      position: absolute;
      background: rgba(0, 0, 0, 0.4);
      width: 100%;
    }

    .video-container video {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 0;
      bottom: 0;
    }

    .video-container video.fillWidth {
      width: 100%;
    }

    .title-container {
      position: absolute;
      top: 35%;
      left: 0;
      right: 0;
      font-family: 'Roboto', sans-serif;
      z-index: 999;
    }

    .title-container .headline {
      text-align: center;
      color: #fff;
    }

    .title-container h3, .title-container h5 {
      position: relative;
      font-weight: 300;
    }

    .title-container h3 {
      font-size: 42px;
      line-height: 44px;
      margin: 15px 0 10px;
    }

    .title-container h5 {
      font-size: 22px;
      margin: 20px 0 0;
    }

    </style>
    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-101659054-2', 'auto');
        ga('send', 'pageview');

    </script>



    <!-- favicon -->
    
    <link rel="icon" href="/images/favicon.ico">
    

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>

    <script>
        //jQuery is required to run this code
    $( document ).ready(function() {

        scaleVideoContainer();

        initBannerVideoSize('.video-container .poster img');
        initBannerVideoSize('.video-container .filter');
        initBannerVideoSize('.video-container video');

        $(window).on('resize', function() {
            scaleVideoContainer();
            scaleBannerVideoSize('.video-container .poster img');
            scaleBannerVideoSize('.video-container .filter');
            scaleBannerVideoSize('.video-container video');
        });

    });

    function scaleVideoContainer() {

        var height = $(window).height() + 5;
        var unitHeight = parseInt(height) + 'px';
        $('.homepage-hero-module').css('height',unitHeight);

    }

    function initBannerVideoSize(element){

        $(element).each(function(){
            $(this).data('height', $(this).height());
            $(this).data('width', $(this).width());
        });

        scaleBannerVideoSize(element);

    }

    function scaleBannerVideoSize(element){

        var windowWidth = $(window).width(),
        windowHeight = $(window).height() + 5,
        videoWidth,
        videoHeight;

        // console.log(windowHeight);

        $(element).each(function(){
            var videoAspectRatio = $(this).data('height')/$(this).data('width');

            $(this).width(windowWidth);

            if(windowWidth < 1000){
                videoHeight = windowHeight;
                videoWidth = videoHeight / videoAspectRatio;
                $(this).css({'margin-top' : 0, 'margin-left' : -(videoWidth - windowWidth) / 2 + 'px'});

                $(this).width(videoWidth).height(videoHeight);
            }

            $('.homepage-hero-module .video-container video').addClass('fadeIn animated');

        });
    }

    </script>


    <script>
       $(function() {
           $("a[href=#content]").click(function() {
               $("html,body").animate({
                 scrollTop:$("#content").offset().top
               }, "show");
               return false;
           });
       });    
    </script>
</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Justin Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/cychien">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/images/about-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Handlebars模板引擎(2) - Handlebars的使用</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Justin on
                        
                        
                            2017-09-11
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        

<a href="/categories/Programming/">Programming</a>

                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>Handlebars是一個可用於clint端或server端的模板引擎，Handlebars由javascript寫成。</p>
<h2 id="安裝方法"><a href="#安裝方法" class="headerlink" title="安裝方法"></a>安裝方法</h2><p>在創建express時用以下命令</p>
<pre><code>express (project name) --hbs
</code></pre><p>或在不使用express-generator的情況下，使用以下命令自行加入</p>
<pre><code>npm install hbs --save
</code></pre><p>若使用第二種方法，還必須在app.js中將view engine修改為Handlebars</p>
<pre><code>app.set(&apos;view engine&apos;, &apos;hbs&apos;);
</code></pre><h2 id="Handlebars基礎"><a href="#Handlebars基礎" class="headerlink" title="Handlebars基礎"></a>Handlebars基礎</h2><h3 id="大括號的使用"><a href="#大括號的使用" class="headerlink" title="大括號的使用"></a>大括號的使用</h3><p>在Handlebars模板中用 <code>{ { } }</code> 框住的內容是可以被替換的部分，像是</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;p&gt;Hello, <span class="template-variable">&#123;&#123;name&#125;&#125;</span>&lt;/p&gt;</div></pre></td></tr></table></figure>
<p>這樣的一個模板，如果傳入的內容是{name: ‘Justin’}的話，則最終輸出的HTML將會是</p>
<pre><code>&lt;p&gt;Hello, Justin&lt;/p&gt;
</code></pre><p>特別的是如果你想傳如一段HTML，像是{name: ‘&lt;b&gt;Justin&lt;/b&gt;’}<br>使用之前的模板，輸出結果會是</p>
<pre><code>&lt;p&gt;Hello, &amp;lt;b&amp;gt;Justin&amp;lt;/b&amp;gt;&lt;/p&gt;
</code></pre><p>要解決這個問題，必須在模板中使用 <code>{ { { } } }</code> ，它會關閉HTML的轉義功能:</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;p&gt;Hello, <span class="template-variable">&#123;&#123;&#123;name&#125;&#125;</span>&#125;&lt;/p&gt;</div></pre></td></tr></table></figure>
<h3 id="區塊"><a href="#區塊" class="headerlink" title="區塊"></a>區塊</h3><p>為了解釋區塊，我們先來假設一段內容</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    name: 'Golem',</div><div class="line">    type: ['Rock', 'Ground'],</div><div class="line">    quickMoves: [</div><div class="line">                &#123;name: Rock Throw, DPS: 16&#125;, </div><div class="line">                &#123;name: Mud Slap, DPS: 12.9&#125;</div><div class="line">    ],</div><div class="line">    mainMoves: [</div><div class="line">                &#123;name: Stone Edge, DPS: 42.9&#125;, </div><div class="line">                &#123;name: Earthquake, DPS: 35.1&#125;, </div><div class="line">                &#123;name: Rock Blast, DPS: 23.1&#125;</div><div class="line">    ],</div><div class="line">    moveType: 'Rock or Ground' </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>這是一段有關Pokemon Go資料的內容，現在我們來檢視一個可傳入以上內容的模板</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">    &lt;p&gt;Name: <span class="template-variable">&#123;&#123;name&#125;&#125;</span>&lt;/p&gt;</div><div class="line">    &lt;p&gt;</div><div class="line">        <span class="template-tag">&#123;&#123;#<span class="name"><span class="builtin-name">each</span></span> type&#125;&#125;</span></div><div class="line">            <span class="template-variable">&#123;&#123;.&#125;&#125;</span> </div><div class="line">        <span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span></div><div class="line">    &lt;/p&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">        <span class="template-tag">&#123;&#123;#<span class="name"><span class="builtin-name">each</span></span> quickMoves&#125;&#125;</span></div><div class="line">            &lt;li&gt;</div><div class="line">                Move Name: <span class="template-variable">&#123;&#123;name&#125;&#125;</span>, DPS: <span class="template-variable">&#123;&#123;DPS&#125;&#125;</span></div><div class="line">                <span class="template-tag">&#123;&#123;#<span class="name"><span class="builtin-name">if</span></span> ../type&#125;&#125;</span></div><div class="line">                    (<span class="template-variable">&#123;&#123;../../moveType&#125;&#125;</span>)</div><div class="line">                <span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">if</span></span>&#125;&#125;</span></div><div class="line">            &lt;/li&gt;</div><div class="line">        <span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span></div><div class="line">    &lt;/ul&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>原先的內容包括name, type, quickMoves, mainMoves等等屬性，但是在 <code>{ { #each type} }</code> 與 <code>{ { /each} }</code> 之間<strong>進入了另一個”區塊”</strong>，這個區塊的內容只包括了type的陣列，而 <code>{ {.} }</code> 則代表的是當前遍歷到的值</p>
<p>我們再來看看下面比較複雜的結構，一樣這個each區塊將內容改變了，變成只包含了quickMoves陣列，比較特別的是if，<strong>在if區塊中的內容與他的父層是一樣的，但是與他的父層仍舊相隔了一層</strong>，所以在這個例子中你可以看到，第一個 <code>../</code> 先回到父層的內容，也就是只包含了quickMoves陣列的內容，第二個 <code>../</code> 再跑到上一層，也就是回到了最原始、最完整的內容，這時就可以取用moveType的值了</p>
<p>千萬要記得的是: <strong><code>../</code> 代表的父級是就模板結構而言，不是內容本身的結構</strong></p>
<h2 id="後端模板"><a href="#後端模板" class="headerlink" title="後端模板"></a>後端模板</h2><h3 id="View-amp-Layout"><a href="#View-amp-Layout" class="headerlink" title="View &amp; Layout"></a>View &amp; Layout</h3><p>在express專案中有一個資料夾是views，當中存放著一張張的網頁(View)，不過大部分的網頁都有相似的結構，因此我們可以創造出一個Layout，Layout是一個特殊的View，是模板的模板，在hbs中，hbs會尋找名為layout.hbs的這個模板，將這個模板作為Layout</p>
<p>以下是一個例子: </p>
<p>layout.hbs</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;title&gt;<span class="template-variable">&#123;&#123;title&#125;&#125;</span>&lt;/title&gt;</div><div class="line">        &lt;link rel='stylesheet' href='/stylesheets/style.css' /&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        <span class="template-variable">&#123;&#123;&#123;body&#125;&#125;</span>&#125;</div><div class="line">    &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>welcome.hbs</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome! My Friends!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure>
<p>這時你用下列程式碼渲染頁面:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.render(<span class="string">'welcome'</span>, &#123;<span class="attr">title</span>: <span class="string">'Pokemon Go is Fun !'</span>&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>處理順序是這樣的:</p>
<ol>
<li>傳入的內容和welcome.hbs做結合</li>
<li>之後將welcome.hbs的內容放入layout.hbs的body中，同時傳入的內容一樣會與layout.hbs做結合</li>
</ol>
<p>最後顯示的html如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Pokemon Go is Fun !<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">'stylesheet'</span> <span class="attr">href</span>=<span class="string">'/stylesheets/style.css'</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome! My Friends!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>如果你有多個Layout，那麼你只要在傳入的內容裡指定要使用哪一個Layout就可以了，像是:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.render(<span class="string">'welcome'</span>, &#123;<span class="attr">title</span>: <span class="string">'Pokemon Go is Fun !'</span>, <span class="attr">layout</span>: <span class="string">'layout2.hbs'</span>&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>如果你不需要套入Layout，那麼就將layout的值設為null，像是:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.render(<span class="string">'welcome'</span>, &#123;<span class="attr">title</span>: <span class="string">'Pokemon Go is Fun !'</span>, <span class="attr">layout</span>: <span class="literal">null</span>&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>如果你想改變預設的Layout，那麼就更改view option的設定值，加入以下程式:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.set(<span class="string">'view options'</span>, &#123;</div><div class="line">    <span class="attr">layout</span>: layout2.hbs;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Partial"><a href="#Partial" class="headerlink" title="Partial"></a>Partial</h3><p>在不同的網頁上我們經常重複使用了許多相同的元件，如果將這些元件寫在每個檔案裡，不僅網頁內容變得更龐大、更難以維護，在元件的修改上也會變得十分麻煩，所以比較好的做法就是將它抽離，獨自形成一個模板，我們特別稱這種模板為”Partial”</p>
<p>我們先建立一個partial檔案(檔案位子在views/partials/pokemonInfo.hbs):</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"popularPokemon"</span>&gt;</span></span></div><div class="line">    <span class="template-tag">&#123;&#123;#<span class="name"><span class="builtin-name">each</span></span> popularPokemon&#125;&#125;</span><span class="xml"></span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pokemon"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/images/</span></span><span class="template-variable">&#123;&#123;imagePath&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> /&gt;</span></span></div><div class="line">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span>名字: <span class="template-variable">&#123;&#123;name&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>屬性: <span class="template-variable">&#123;&#123;type&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>外部連結: <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"</span></span><span class="template-variable">&#123;&#123;link&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>再來我們要註冊partial，目的是為了在view裡面帶入這個partial，一種方式是註冊單一個partial:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hbs.registerPartial(<span class="string">'pokemonInfo'</span>, fs.readFileSync(__dirname + <span class="string">'/views/partials/pokemonInfo.hbs'</span>, <span class="string">'utf-8'</span>));</div></pre></td></tr></table></figure>
<p>第二種方式是一次註冊整個資料夾內所有的內容</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hbs.registerPartials(__dirname + <span class="string">'/view/partials'</span>);</div></pre></td></tr></table></figure>
<p>之後設定要傳入的內容，為了簡潔一點，我們用一個函式包裝:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPokemonInfo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">popularPokemon</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">imagePath</span>: <span class="string">'Tyranitar.jpg'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'班基拉斯'</span>,</div><div class="line">                <span class="attr">type</span>: <span class="string">'Rock、Dark'</span>,</div><div class="line">                <span class="attr">link</span>: <span class="string">'https://pokemon.gameinfo.io/zh-tw/pokemon/248-tyranitar'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">imagePath</span>: <span class="string">'Dragonite.jpg'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'快龍'</span>,</div><div class="line">                <span class="attr">type</span>: <span class="string">'Dragon、Fly'</span>,</div><div class="line">                <span class="attr">link</span>: <span class="string">'https://pokemon.gameinfo.io/zh-tw/pokemon/149-dragonite'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">imagePath</span>: <span class="string">'Golem.jpg'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'隆隆岩'</span>,</div><div class="line">                <span class="attr">type</span>: <span class="string">'Rock、Ground'</span>,</div><div class="line">                <span class="attr">link</span>: <span class="string">'https://pokemon.gameinfo.io/zh-tw/pokemon/76-golem'</span>	</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>你可以用如下的方式傳輸數據:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.locals = getPokemonInfo();</div><div class="line">    res.render(<span class="string">'welcome'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>然後在welcome.hbs裡添加這個partial:</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome! My Friends!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line"><span class="template-variable">&#123;&#123;&gt; pokemonInfo&#125;&#125;</span><span class="xml"></span></div></pre></td></tr></table></figure>
<p>就大功告成了!<br>當然這種做法還稱不上是完美，原因是你每次需要這份partial時，都要傳一次pokemonInfo內容，我們換種寫法，讓所有的view都能使用這份pokemonInfo內容，用的方式是加入中介軟體:  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">    res.locals = getPokemonInfo();</div><div class="line">    next();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>這樣就能為資料注入res.locals物件，而不用在每個路由處理程式裡都寫一次</p>
<h3 id="Helper"><a href="#Helper" class="headerlink" title="Helper"></a>Helper</h3><p>Handlebars是一個弱邏輯的模板引擎，舉個例子，你在前面看到的 <code>{ { #if} }</code> ，後面是不能接判斷式的，像 <code>{ { #if type!=null} }</code> 和 <code>{ { #if type&amp;&amp;name} }</code> 都是不合法的，但如果你想要處理更複雜的邏輯該怎麼辦呢?這時你就需要helper的協助了。</p>
<p>你可以想像helper是一個自訂義標籤，它可以在handlebars模板的任何地方，helper和partial一樣需要被事先的註冊，底下是一個簡單的helper:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">hbs.registerHelper(<span class="string">'list'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">context, option</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> out = <span class="string">"&lt;/ul&gt;"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;context.length; i++) &#123;</div><div class="line">        out = out + <span class="string">"&lt;li&gt;"</span> + options.fn(context[i]) + <span class="string">"&lt;/li&gt;"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> out + <span class="string">"&lt;/ul&gt;"</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>在解釋以上語法之前，我們先來看看傳入的內容(context)是什麼:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    people: [</div><div class="line">        &#123;firstName: 'Justin', lastName: 'Chien'&#125;,</div><div class="line">        &#123;firstName: 'Jack', lastName: 'Lee'&#125;,</div><div class="line">        &#123;firstName: 'Mandy', lastNmae: 'Wu'&#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第一個參數 <code>list</code> 是這個自定義標籤的名字，第二個參數則傳入一個function，代表你想要做到的事，function的第一個參數傳入一段context，如果沒有設則是同於當前的context，第二個參數 <code>option</code> 有一個方法 <code>fn</code> ， 假設在你的list區塊中還有其他的模板，那麼 <code>option.fn()</code> 代表的就會是編譯過的那些模板，當你傳入一段context時，它就會回傳出相應的HTML，底下是一個實際應用的例子:</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="xml"></span><span class="template-tag">&#123;&#123;#<span class="name">list</span> people&#125;&#125;</span><span class="xml"></span><span class="template-variable">&#123;&#123;firstName&#125;&#125;</span><span class="xml"> </span><span class="template-variable">&#123;&#123;lastName&#125;&#125;</span><span class="xml"></span><span class="template-tag">&#123;&#123;/<span class="name">list</span>&#125;&#125;</span><span class="xml"></span></div></pre></td></tr></table></figure>
<p>嘗試理解一下，people代表現在的context已經被鎖定在people陣列中，而此時的option.fn()代表的是被編譯過的 <code>{ {firstName} } { {lastName} }</code> ，譬如將{firstName: ‘Justin’, lastName: ‘Chien’}傳入option.fn()，它就會回傳給你 <code>Chien Justin</code> ，所以最終的結果會是這樣:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Justin Chien<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Jack Lee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Mandy Wu<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<p>老實說前面看到的 <code>{ { #if} }</code> 、 <code>{ { #each} }</code> 都是helper，只是他們是內建的helper，其他內建的helper還有 <code>{ { #with} }</code> 、 <code>{ { #unless} }</code> 等等，可以在<a href="https://segmentfault.com/a/1190000000342636" target="_blank" rel="external">此連結</a>中查看</p>
<h2 id="前端模板"><a href="#前端模板" class="headerlink" title="前端模板"></a>前端模板</h2><p>在前端中一樣可以引入Handlebars，步驟是這樣的:  </p>
<ol>
<li><p>將Handlebars下載後放入靜態內容或直接使用CDN</p>
</li>
<li><p>寫一個模板</p>
</li>
<li><p>編譯模板</p>
</li>
<li><p>將內容(context)傳入編譯後的模板</p>
</li>
</ol>
<p>為了方便理解，底下是一個簡單的例子，首先引入Handlebars:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.10/handlebars.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>再來寫一個模板:</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">"template"</span> <span class="attr">type</span>=<span class="string">"text/x-handlebars-template"</span>&gt;</span><span class="undefined"></span></span></div><div class="line">    Hi! My name is <span class="template-variable">&#123;&#123;&#123;name&#125;&#125;</span><span class="xml"><span class="undefined">&#125;.</span></span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>然後編譯它:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> compiledTemplate = Handlebars.compile($(<span class="string">'#template'</span>).html());</div></pre></td></tr></table></figure>
<p>最後將內容傳入編譯後的模板:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">var data = &#123;name: 'Kevin'&#125;;</div><div class="line">$('#result').html(compiledTemplate(data));</div></pre></td></tr></table></figure>
<p>當然你一樣可以在前端模板中使用partial、helper等特性，就像Handlebars用於後端時的那樣</p>
<p>這篇文章主要講述一些Handlebars的基礎功能，在之後的文章中我們再來探討更多Handlebars可以做到的事</p>


                
                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5994f9788dcd71ae"></script>

                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <div class="addthis_inline_share_toolbox"></div>
                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
    <hr />
    <h3>Kommentare:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/cychien" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:xyz030206@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2017 Justin Chien<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'cychien';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>